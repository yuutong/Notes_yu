
同心双圆环靶标相机标定算法


### 一、大白话总结

1. **为什么不用棋盘或普通圆点靶标**

   * 棋盘格在旋转视角下容易模糊，导致角点提取不准。
   * 圆点靶标投影成椭圆时拟合的圆心点也略有偏差。

2. **同心双圆环靶标优势**

   * 两个共中心的圆环提供多个圆心候选项。
   * 根据代数几何的“共同自极三角形”理论，可以从图中抽取真正圆心。
   * 多个圆环组合提高鲁棒性，避免单环误差。

3. **算法流程**

   * 相机拍摄到靶标图像后，先检测并拟合出所有圆环边缘为椭圆。
   * 对每对同心圆环组合，通过求解其对应的矩阵特征值/向量，得到圆心在图像中的坐标。
   * 使用多个组合中的最优者（误差最小的）得到最准确的圆心。

---

### 二、数学逻辑与公式解释

假设图像中检测到一对同心圆环，圆环在图像中被拟合成椭圆，对应的齐次二次曲线矩阵为：

$$
C_1 = \begin{bmatrix}1 & 0 & -x_0 \\ 0 & 1 & -y_0 \\ -x_0 & -y_0 & x_0^2 + y_0^2 - r_1^2\end{bmatrix},\quad
C_2 = \begin{bmatrix}1 & 0 & -x_0 \\ 0 & 1 & -y_0 \\ -x_0 & -y_0 & x_0^2 + y_0^2 - r_2^2\end{bmatrix}
$$

* $(x_0, y_0)$ 是靶标在图像平面上的中心坐标，$r_1, r_2$ 是两个圆的半径。

它们的性质有：

* 两个共心圆的“共同自极三角形”中的公共顶点就是圆心。
* 它们的公共极点是矩阵$(C_2^{-1} C_1)$的特征向量，对应的特征值为 $[1, 1, r_1^2 / r_2^2]$。

具体推导步骤：

1. **构造矩阵关系**

   $$
   (C_1 - \lambda C_2)x = 0 \quad \Longrightarrow \quad (C_2^{-1} C_1 - \lambda I) x = 0
   $$

   这里 $x = [x_0, y_0, 1]^T$ 是圆心的齐次坐标，$\lambda$ 是特征值。

2. **特征值特征向量问题**

   * 计算特征值与特征向量：

     $$
     C_2^{-1} C_1 \, V = V \, D
     $$

     其中对角矩阵 $D = \mathrm{diag}(1, 1, r_1^2 / r_2^2)$，对应特征向量 $V$ 的第三列就是 $[x_0, y_0, 1]^T$。

3. **选择最优圆心**

   * 若有 $N$ 个圆环，共有 $\binom{N}{2}$ 种组合，对每对组合做上述特征分解得圆心，然后选误差最小的作为最终结果。

---

### 总结

* **原理核心**：用矩阵特征分解自动定位圆心，无需手动拟合几何中心，避免透视畸变误差。
* **双圆环优势**：提供组合冗余，选最优增强鲁棒。
* **流程清晰**：检测 → 椭圆拟合 → 构建 $C_1, C_2$ → 特征分解 → 选最佳圆心。

这就是“同心双圆环靶标”在结构光相机中用于高精度相机标定的原理和实现方法。
