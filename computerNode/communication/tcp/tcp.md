# TCP通信
  TCP （传输控制协议）是⼀种⾯向连接的、可靠的、基于字节流的传输层通信协议

## 特点：
   有连接， 传输可靠，传输字节流 传输效率慢，所需资源多

## 三次握手四次挥手
   *三次握手：1.客户端发送请求报文；(SYN = 1,ACK = 0,seq = x)2.服务器确认，服务器发送请求；(SYN = 1, ACK = 1, seq = y ) 3.客户端确认(SYN = 0, ACK = 1, seq = x+1)。连接建立
   Q:为什么不是2次或4次握手：可能造成资源的浪费，如果没有第三次握手，服务器就不知道客户端是否收到了自己的回复。这样服务器下次再收到请求报文，还会去创建一个TCP连接。而三次握手连接建立之后，双方都会变为established状态，不会再对同一个客户端创建新的连接。4次握手可以简化为3次。
   *四次挥手：由于TCP是全双工通信，可双向传输数据。任一方发送关闭连接请求，等对方确认，就关闭了单向的连接，关闭双向需要四次挥手。

## TCP连接如何确保可靠性
   1.数据块大小控制：分割成协议认为最合适发送的数据块，从传输层送到网络层
   2.系列号：发送方给每个数据包指定序列号，接收方根据序列号对数据包排序去重
   3.校验和：首部和数据校验和，检测数据在传输过程中的变化，如检测到差错，丢弃数据包
   4.流量控制：发送方和接收方都有缓冲区，接收端只允许发送端发送接收端缓冲区能接纳的数据。采用滑动窗口来实现
   5.拥塞控制：当出现发送计时器超时或数据包重复确认时，减少数据的发送
   6.确认应答：ARQ协议，每发完一个分组就停止发送，等待对方确认，确认后再发送下一个分组
   7.超时重传：发送端发送一个数据包后，启动一个定时器，超时就重发

## TCP拥塞控制的实现
   1.慢启动，发送方在连接最开始发1个，以指数速度增加发送的数据量
   2.拥塞避免：发送窗口到达阈值后，发送方减少发送速率为线性增加
   3.超时重传：发送端发送一个数据包后，启动一个定时器，超时就重发
   4.快速重传，快速恢复：若接收方收到重复确认-->数据包丢失；不等计时器超时直接重发
   5.拥塞窗口调整：通过检测网络延迟和丢包情况来确定发送放的发送速率，减少拥塞的可能性

## HTTP的多个TCP连接怎么实现
   多个tcp连接是靠某些服务器对 Connection: keep-alive 的 Header 进⾏了
   ⽀持。简⽽⾔之，完成这个 HTTP 请求之后，不要断开 HTTP 请求使⽤的 TCP 连接。这样的好处是连接可以被重
   新使⽤，之后发送 HTTP 请求的时候不需要重新建⽴ TCP 连接，以及如果维持连接，那么 SSL 的开销也可以避免。





